# FactGuardian 项目分工总结

## 成员分工概览

| 成员 | 学号 | 主要职责 | 核心交付物 |
|------|------|----------|------------|
| **詹江叶煜** | 10235501471 | 冲突监测功能的实现 | `conflict_detector.py` |
| **马舒童** | 10235501462 | 冲突监测功能优化与前端页面搭建 | `ConflictList.jsx`, `DocumentViewer.jsx` |
| **张欣扬** | 10235501413 | 扩展功能的实现 | `reference_comparator.py`, `image_extractor.py`, `image_text_comparator.py` |

---

## 详细分工

### 詹江叶煜 - 冲突监测功能实现

**核心任务：**
1. ✅ 实现冲突检测核心算法（`ConflictDetector` 类）
2. ✅ 设计冲突检测 Prompt 模板
3. ✅ 实现智能事实对生成（结构化字段驱动）
4. ✅ 实现批量并行处理优化（`batch_size=10`）
5. ✅ 实现重复内容检测
6. ✅ 实现冲突检测 API 端点

**技术栈：** Python, FastAPI, asyncio, DeepSeek API

**关键文件：**
- `backend/app/services/conflict_detector.py` (734行)
- `backend/app/main.py` (冲突检测相关端点)

**验收标准：**
- ✅ 能够检测数据不一致、逻辑矛盾、时间冲突
- ✅ 能够识别高频重复段落（3次以上）
- ✅ 300对事实在15-20秒内完成
- ✅ JSON 解析容错完善

---

### 马舒童 - 冲突监测功能优化与前端页面搭建

**核心任务：**
1. ✅ 优化冲突检测性能（批量处理、进度更新频率）
2. ✅ 实现冲突列表组件（`ConflictList.jsx`）
3. ✅ 实现文档查看器冲突高亮（`DocumentViewer.jsx`）
4. ✅ 实现重复内容展示（`RepetitionList.jsx`）
5. ✅ 实现进度显示优化（`FunLoading.jsx`）
6. ✅ 用户体验优化（筛选、搜索、响应式设计）

**技术栈：** React, JavaScript, Tailwind CSS, SSE

**关键文件：**
- `frontend/src/components/ConflictList.jsx`
- `frontend/src/components/DocumentViewer.jsx`
- `frontend/src/components/RepetitionList.jsx`
- `frontend/src/components/FunLoading.jsx`

**验收标准：**
- ✅ 冲突列表正确显示所有冲突
- ✅ 冲突高亮准确标记文档位置
- ✅ 点击冲突能够跳转到对应位置
- ✅ 进度显示实时更新
- ✅ 响应式设计，支持不同屏幕

---

### 张欣扬 - 扩展功能实现

**核心任务：**

**1. 参考文档对比功能：**
- ✅ 实现多文件上传 API (`/api/upload-multiple`)
- ✅ 实现参考对比服务 (`ReferenceComparator`)
- ✅ 实现参考对比 API (`/api/compare-references`)
- ✅ 实现相似度计算（0-100%）
- ✅ 实现相似类型识别（直接引用/改写/思想借鉴）

**2. 图片/框架图对比功能：**
- ✅ 实现图片提取服务 (`ImageExtractor`)
- ✅ 集成多 Vision API（Claude / GPT-4V / 豆包）
- ✅ 实现图片提取 API (`/api/extract-from-image`)
- ✅ 实现图文对比服务 (`ImageTextComparator`)
- ✅ 实现图文对比 API (`/api/compare-image-text`)
- ✅ 实现前端组件（`MultiDocComparison.jsx`, `ImageTextComparison.jsx`）

**技术栈：** Python, FastAPI, Vision API (Claude/GPT-4V/豆包), React

**关键文件：**
- `backend/app/services/reference_comparator.py` (229行)
- `backend/app/services/image_extractor.py` (405行)
- `backend/app/services/image_text_comparator.py` (223行)
- `frontend/src/components/MultiDocComparison.jsx`
- `frontend/src/components/ImageTextComparison.jsx`

**验收标准：**
- ✅ 能够检测明显的改写段落
- ✅ 相似度判断基本准确
- ✅ 能够识别架构图、流程图等
- ✅ 能够判断文档与图片的一致性
- ✅ 支持多种 Vision API

---

## API 端点汇总

### 冲突检测（詹江叶煜）
- `POST /api/detect-conflicts/{document_id}` - 触发冲突检测
- `GET /api/conflicts/{document_id}` - 获取冲突结果

### 扩展功能（张欣扬）
- `POST /api/upload-multiple` - 多文件上传
- `POST /api/compare-references` - 参考文档对比
- `POST /api/extract-from-image` - 图片内容提取
- `POST /api/compare-image-text` - 图文对比

---

## 代码统计

| 成员 | 主要文件 | 代码行数 |
|------|----------|---------------|
| 詹江叶煜 | `conflict_detector.py` | 734行 |
| 马舒童 | `ConflictList.jsx` + `DocumentViewer.jsx` + 其他组件 | 900行 |
| 张欣扬 | `reference_comparator.py` + `image_extractor.py` + `image_text_comparator.py` | 857行 |

---

## 协作接口

### 数据格式
- **冲突数据**：`conflict_id`, `has_conflict`, `conflict_type`, `severity`, `explanation`
- **参考对比**：`similarities[]`, `similarity_score`, `similarity_type`, `needs_citation`
- **图文对比**：`is_consistent`, `consistency_score`, `missing_elements[]`, `contradictions[]`

### 进度推送
- 使用 SSE (`/api/progress/{document_id}`) 实现实时进度更新
- 前端通过 `EventSource` 订阅进度事件
